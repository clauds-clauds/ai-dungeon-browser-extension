<div id="extension-main-menu" class="extension-menu-container menu-overhaul">
    <div class="menu-outer">
        <aside class="menu-sidebar">
            <div class="menu-sidebar-top">
                <!-- 
                <div class="menu-brand">
                    <span class="material-symbols-rounded brand-icon">auto_fix_high</span>
                    <div class="brand-copy">
                        <h2>Dungeon Extension</h2>
                        <p>Craft and orchestrate the helpers powering your adventures.</p>
                    </div>
                </div> -->

                <nav class="menu-tab-stack menu-tabs">
                    <button class="menu-tab active" data-tab="entities">
                        <span class="material-symbols-rounded">api</span>
                        <span>Entities</span>
                    </button>
                    <button class="menu-tab" data-tab="editor">
                        <span class="material-symbols-rounded">handyman</span>
                        <span>Editor</span>
                    </button>
                    <button class="menu-tab" data-tab="settings">
                        <span class="material-symbols-rounded">settings</span>
                        <span>Settings</span>
                    </button>
                    <button class="menu-tab" data-tab="sharing">
                        <span class="material-symbols-rounded">folder_copy</span>
                        <span>Sharing</span>
                    </button>
                </nav>
            </div>

            <div class="menu-sidebar-bottom">
                <div class="sidebar-chip">
                    <span class="chip-label">Adventure</span>
                    <span class="chip-value" id="info-adventure-id">You should not be able to see this.</span>
                </div>
                <div class="sidebar-chip">
                    <span class="chip-label">Version</span>
                    <span class="chip-value" id="info-plugin-version">You should not be able to see this.</span>
                </div>
            </div>
        </aside>

        <section class="menu-main">
            <header class="menu-topbar">
                <div class="menu-topbar-copy">
                    <h2>Extension Menu</h2>
                    <p>Manage your entity library, author profiles, highlight styling, and sharing workflows from a
                        single workspace.</p>
                </div>
                <button id="menu-close-btn" class="menu-close-btn" aria-label="Close menu">
                    <span class="material-symbols-rounded">close</span>
                </button>
            </header>

            <div class="menu-content">
                <div class="menu-tab-content">
                    <div id="entities-tab" class="tab-panel active">
                        <div class="menu-panel-surface">
                            <header class="panel-header">
                                <div>
                                    <h3>Entity Library</h3>
                                    <p>Browse, sort, and refine the characters, places, factions, and custom lore
                                        driving your narrative.</p>
                                </div>
                                <button id="add-entity-btn" class="add-entity-btn emphasis">
                                    <span class="material-symbols-rounded">note_stack_add</span>
                                    Add Entity
                                </button>
                            </header>

                            <div class="sub-menu-tabs pill-tabs">
                                <button class="sub-menu-tab active" data-subtab="all">
                                    <span class="material-symbols-rounded">view_list</span>
                                    All
                                </button>
                                <button class="sub-menu-tab" data-subtab="characters">
                                    <span class="material-symbols-rounded">groups_2</span>
                                    Characters
                                </button>
                                <button class="sub-menu-tab" data-subtab="races">
                                    <span class="material-symbols-rounded">sword_rose</span>
                                    Races
                                </button>
                                <button class="sub-menu-tab" data-subtab="locations">
                                    <span class="material-symbols-rounded">explore</span>
                                    Locations
                                </button>
                                <button class="sub-menu-tab" data-subtab="factions">
                                    <span class="material-symbols-rounded">castle</span>
                                    Factions
                                </button>
                                <button class="sub-menu-tab" data-subtab="custom">
                                    <span class="material-symbols-rounded">category</span>
                                    Custom
                                </button>
                            </div>

                            <div class="panel-body">
                                <div class="entities-search-container menu-surface-card">
                                    <div class="search-input-wrapper">
                                        <span class="material-symbols-rounded search-icon">search</span>
                                        <input type="text" id="entities-search-input"
                                            placeholder="Search entities..." />
                                        <button id="clear-search-btn" class="clear-search-btn" style="display: none;">
                                            <span class="material-symbols-rounded">close</span>
                                        </button>
                                    </div>
                                    <p class="search-subtext">Filter your roster or jump into categories to focus on a
                                        specific slice of your world.</p>
                                </div>

                                <div class="tab-content-area">
                                    <div id="all-subtab" class="subtab-panel active">
                                        <!-- Inject Entity Render for `All` -->
                                    </div>
                                    <div id="characters-subtab" class="subtab-panel">
                                        <!-- Inject Entity Render for `Characters` -->
                                    </div>
                                    <div id="races-subtab" class="subtab-panel">
                                        <!-- Inject Entity Render for `Races` -->
                                    </div>
                                    <div id="locations-subtab" class="subtab-panel">
                                        <!-- Inject Entity Render for `Locations` -->
                                    </div>
                                    <div id="factions-subtab" class="subtab-panel">
                                        <!-- Inject Entity Render for `Factions` -->
                                    </div>
                                    <div id="custom-subtab" class="subtab-panel">
                                        <!-- Inject Entity Render for `Custom` -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="editor-tab" class="tab-panel">
                        <div class="menu-panel-surface">
                            <header class="panel-header">
                                <div>
                                    <h3>Entity Editor</h3>
                                    <p>Swap into authoring mode to sculpt detailed profiles, upload artwork, and tune
                                        highlight behaviour.</p>
                                </div>
                                <span class="panel-context-badge">
                                    <span class="material-symbols-rounded">lightbulb</span>
                                    Tip: Save an entity to return here automatically next time.
                                </span>
                            </header>

                            <div class="panel-body">
                                <div class="sub-menu-tabs soft-tabs">
                                    <button class="sub-menu-tab active" data-subtab="entity">
                                        <span class="material-symbols-rounded">api</span>
                                        Entity
                                    </button>
                                </div>
                                <div class="tab-content-area">
                                    <div id="entity-subtab" class="subtab-panel active">
                                        <!-- Inject Editor Here! -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="settings-tab" class="tab-panel">
                        <div class="menu-panel-surface">
                            <header class="panel-header">
                                <div>
                                    <h3>Extension Settings</h3>
                                    <p>Fine-tune how highlights render, control tooltip pacing, and keep your session
                                        data tidy.</p>
                                </div>
                                <span class="panel-context-badge">
                                    <span class="material-symbols-rounded">settings_suggest</span>
                                    Settings apply instantly across your active adventure.
                                </span>
                            </header>

                            <div class="sub-menu-tabs soft-tabs">
                                <button class="sub-menu-tab active" data-subtab="general-settings">
                                    <span class="material-symbols-rounded">tune</span>
                                    General
                                </button>
                                <button class="sub-menu-tab" data-subtab="highlight-settings">
                                    <span class="material-symbols-rounded">text_fields</span>
                                    Text Effects
                                </button>
                                <button class="sub-menu-tab" data-subtab="tooltip-settings">
                                    <span class="material-symbols-rounded">tooltip</span>
                                    Tooltip
                                </button>
                                <button class="sub-menu-tab" data-subtab="storage-settings">
                                    <span class="material-symbols-rounded">folder_data</span>
                                    Storage
                                </button>
                                <button id="danger-zone" class="sub-menu-tab" data-subtab="danger-settings">
                                    <span class="material-symbols-rounded">skull</span>
                                    Danger Zone
                                </button>
                            </div>

                            <div class="panel-body tab-content-area">
                                <div id="general-settings-subtab" class="subtab-panel active">
                                    <div class="menu-info-grid">
                                        <div class="menu-info-chip">
                                            <span class="chip-icon material-symbols-rounded">route</span>
                                            <div>
                                                <span class="chip-label">Adventure ID</span>
                                                <span class="chip-value" data-mirror="#info-adventure-id"></span>
                                            </div>
                                        </div>
                                        <div class="menu-info-chip">
                                            <span class="chip-icon material-symbols-rounded">verified</span>
                                            <div>
                                                <span class="chip-label">Extension Version</span>
                                                <span class="chip-value" data-mirror="#info-plugin-version"></span>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="menu-surface-card">
                                        <h4>Welcome aboard!</h4>
                                        <p class="card-lead">Hey! Hey you! Thanks for installing <strong
                                                id="orange">Dungeon Extension!</strong> I hope you enjoy using it!</p>
                                        <p>If anything is wrong, feel free to DM me on the AI Dungeon Discord server.
                                        </p>
                                        <p><strong id="orange">&lt;3 - Claudia</strong></p>
                                    </div>
                                </div>

                                <div id="highlight-settings-subtab" class="subtab-panel">
                                    <div class="menu-surface-card stack">
                                        <div class="settings-section">
                                            <div class="info-row">
                                                <label for="setting-textEffectsEnabled">Enabled</label>
                                                <div class="toggle-switch">
                                                    <input type="checkbox" id="setting-textEffectsEnabled"
                                                        variable="textEffectsEnabled">
                                                    <label for="setting-textEffectsEnabled"></label>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="settings-section">
                                            <div class="info-row">
                                                <label for="setting-textEffectsColor">Colored Text</label>
                                                <div class="toggle-switch">
                                                    <input type="checkbox" id="setting-textEffectsColor"
                                                        variable="textEffectsColor">
                                                    <label for="setting-textEffectsColor"></label>
                                                </div>
                                            </div>
                                            <div class="info-row">
                                                <label for="setting-textEffectsBold">Bold Text</label>
                                                <div class="toggle-switch">
                                                    <input type="checkbox" id="setting-textEffectsBold"
                                                        variable="textEffectsBold">
                                                    <label for="setting-textEffectsBold"></label>
                                                </div>
                                            </div>
                                            <div class="info-row">
                                                <label for="setting-textEffectsStory">Apply to Story</label>
                                                <div class="toggle-switch">
                                                    <input type="checkbox" id="setting-textEffectsStory"
                                                        variable="textEffectsStory">
                                                    <label for="setting-textEffectsStory"></label>
                                                </div>
                                            </div>
                                            <div class="info-row">
                                                <label for="setting-textEffectsDialogue">Apply to Dialogue</label>
                                                <div class="toggle-switch">
                                                    <input type="checkbox" id="setting-textEffectsDialogue"
                                                        variable="textEffectsDialogue">
                                                    <label for="setting-textEffectsDialogue"></label>
                                                </div>
                                            </div>
                                            <div class="info-row">
                                                <label for="setting-textEffectsIcon">Inline Icon</label>
                                                <div class="toggle-switch">
                                                    <input type="checkbox" id="setting-textEffectsIcon"
                                                        variable="textEffectsIcon">
                                                    <label for="setting-textEffectsIcon"></label>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="settings-section grid">
                                            <div class="slider-group">
                                                <div class="slider-label">
                                                    <label for="setting-textEffectsIconSize">Icon Size</label>
                                                    <button type="button" class="reset-btn"
                                                        data-target="setting-textEffectsIconSize">RESET</button>
                                                </div>
                                                <div class="input-with-slider">
                                                    <input type="number" id="setting-textEffectsIconSize" min="8"
                                                        max="64" value="28" variable="textEffectsIconSize">
                                                    <input type="range" id="setting-textEffectsIconSize-slider" min="8"
                                                        max="64" value="28" variable="textEffectsIconSize">
                                                </div>
                                            </div>
                                            <div class="slider-group">
                                                <div class="slider-label">
                                                    <label for="setting-textEffectsIconBorderWidth">Icon Border
                                                        Width</label>
                                                    <button type="button" class="reset-btn"
                                                        data-target="setting-textEffectsIconBorderWidth">RESET</button>
                                                </div>
                                                <div class="input-with-slider">
                                                    <input type="number" id="setting-textEffectsIconBorderWidth" min="0"
                                                        max="16" value="1" variable="textEffectsIconBorderWidth">
                                                    <input type="range" id="setting-textEffectsIconBorderWidth-slider"
                                                        min="0" max="16" value="1"
                                                        variable="textEffectsIconBorderWidth">
                                                </div>
                                            </div>
                                            <div class="slider-group">
                                                <div class="slider-label">
                                                    <label for="setting-textEffectsIconBorderRadius">Icon Border
                                                        Radius</label>
                                                    <button type="button" class="reset-btn"
                                                        data-target="setting-textEffectsIconBorderRadius">RESET</button>
                                                </div>
                                                <div class="input-with-slider">
                                                    <input type="number" id="setting-textEffectsIconBorderRadius"
                                                        min="0" max="50" value="0"
                                                        variable="textEffectsIconBorderRadius">
                                                    <input type="range" id="setting-textEffectsIconBorderRadius-slider"
                                                        min="0" max="50" value="0"
                                                        variable="textEffectsIconBorderRadius">
                                                </div>
                                            </div>
                                        </div>

                                        <div class="settings-section grid">
                                            <div class="info-row">
                                                <label for="setting-textEffectsColorDefault">Color (Default)</label>
                                                <input type="color" id="setting-textEffectsColorDefault" value="#f8ae2c"
                                                    variable="textEffectsColorDefault">
                                            </div>
                                            <div class="info-row">
                                                <label for="setting-textEffectsColorGlobal">Color (Global)</label>
                                                <input type="color" id="setting-textEffectsColorGlobal" value="#f8ae2c"
                                                    variable="textEffectsColorGlobal">
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div id="tooltip-settings-subtab" class="subtab-panel">
                                    <div class="menu-surface-card stack">
                                        <div class="settings-section">
                                            <div class="info-row">
                                                <label for="setting-tooltipEnabled">Enabled</label>
                                                <div class="toggle-switch">
                                                    <input type="checkbox" id="setting-tooltipEnabled"
                                                        variable="tooltipEnabled">
                                                    <label for="setting-tooltipEnabled"></label>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="settings-section grid">
                                            <div class="slider-group">
                                                <div class="slider-label">
                                                    <label for="setting-tooltipScale">Scale (%)</label>
                                                    <button type="button" class="reset-btn"
                                                        data-target="setting-tooltipScale">RESET</button>
                                                </div>
                                                <div class="input-with-slider">
                                                    <input type="number" id="setting-tooltipScale" min="0" max="100"
                                                        value="25" variable="tooltipScale">
                                                    <input type="range" id="setting-tooltipScale-slider" min="0"
                                                        max="100" value="25" variable="tooltipScale">
                                                </div>
                                            </div>

                                            <div class="slider-group">
                                                <div class="slider-label">
                                                    <label for="setting-tooltipHideDelay">Hide Delay (ms)</label>
                                                    <button type="button" class="reset-btn"
                                                        data-target="setting-tooltipHideDelay">RESET</button>
                                                </div>
                                                <div class="input-with-slider">
                                                    <input type="number" id="setting-tooltipHideDelay" min="0"
                                                        max="1000" value="400" variable="tooltipHideDelay">
                                                    <input type="range" id="setting-tooltipHideDelay-slider" min="0"
                                                        max="1000" value="400" variable="tooltipHideDelay">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div id="storage-settings-subtab" class="subtab-panel">
                                    <div class="menu-surface-card">
                                        <h4>Storage overview</h4>
                                        <p>Storage management tooling is still in progress. Keep an eye on this panel
                                            for import/export automation and visual usage metrics.</p>
                                        <p class="card-footnote">Tip: Use the sharing tab to draft the upcoming
                                            workflow.</p>
                                    </div>
                                </div>

                                <div id="danger-settings-subtab" class="subtab-panel">
                                    <div class="menu-action-grid">
                                        <div class="menu-action-card danger">
                                            <div class="menu-action-header">
                                                <span class="material-symbols-rounded menu-action-icon">warning</span>
                                                <div class="menu-action-text">
                                                    <h3 class="menu-action-title">Delete Database</h3>
                                                    <p class="menu-action-description">Remove all stored settings and
                                                        entities for this adventure. This cannot be undone.</p>
                                                </div>
                                            </div>
                                            <div class="menu-action-note">
                                                <span class="material-symbols-rounded">info</span>
                                                <span>Make sure you export anything important before you continue. There
                                                    is no recovery once deleted.</span>
                                            </div>
                                            <div class="menu-action-buttons">
                                                <button type="button" id="danger-delete-database-btn"
                                                    class="menu-action-button danger">
                                                    <span class="material-symbols-rounded">delete_forever</span>
                                                    Delete Database
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="sharing-tab" class="tab-panel">
                        <div class="menu-panel-surface">
                            <header class="panel-header">
                                <div>
                                    <h3>Sharing &amp; Sync</h3>
                                    <p>Plan your import/export pipeline so collaborators can plug into the same
                                        adventure resources.</p>
                                </div>
                                <span class="panel-context-badge">
                                    <span class="material-symbols-rounded">share</span>
                                    Coming soon â€” prep your workflow ahead of the tooling rollout.
                                </span>
                            </header>

                            <div class="sub-menu-tabs soft-tabs">
                                <button class="sub-menu-tab active" data-subtab="import">
                                    <span class="material-symbols-rounded">file_download</span>
                                    Import
                                </button>
                                <button class="sub-menu-tab" data-subtab="export">
                                    <span class="material-symbols-rounded">file_upload</span>
                                    Export
                                </button>
                            </div>

                            <div class="panel-body tab-content-area">
                                <div id="import-subtab" class="subtab-panel active">
                                    <div class="menu-action-grid">
                                        <div class="menu-action-card">
                                            <div class="menu-action-header">
                                                <span
                                                    class="material-symbols-rounded menu-action-icon">file_download</span>
                                                <div class="menu-action-text">
                                                    <h3 class="menu-action-title">Import Entities</h3>
                                                    <p class="menu-action-description">Restore entities from a previous
                                                        export or a shared configuration file.</p>
                                                </div>
                                            </div>
                                            <div class="menu-action-buttons">
                                                <button type="button" class="menu-action-button primary"
                                                    id="import-select-btn">
                                                    <span class="material-symbols-rounded">upload_file</span>
                                                    Select File
                                                </button>
                                                <button type="button" class="menu-action-button outline"
                                                    id="import-paste-btn">
                                                    <span class="material-symbols-rounded">content_paste</span>
                                                    Paste JSON
                                                </button>
                                            </div>
                                            <p class="menu-action-footnote">Import functionality is coming soon. Use
                                                these placeholders to plan the desired flow.</p>
                                        </div>
                                    </div>
                                </div>

                                <div id="export-subtab" class="subtab-panel">
                                    <div class="menu-action-grid">
                                        <div class="menu-action-card">
                                            <div class="menu-action-header">
                                                <span
                                                    class="material-symbols-rounded menu-action-icon">file_upload</span>
                                                <div class="menu-action-text">
                                                    <h3 class="menu-action-title">Export Entities</h3>
                                                    <p class="menu-action-description">Generate a backup of your
                                                        entities and settings to share or archive.</p>
                                                </div>
                                            </div>
                                            <div class="menu-action-buttons">
                                                <button type="button" class="menu-action-button primary"
                                                    id="export-start-btn">
                                                    <span class="material-symbols-rounded">cloud_download</span>
                                                    Download Export
                                                </button>
                                                <button type="button" class="menu-action-button outline"
                                                    id="export-copy-btn">
                                                    <span class="material-symbols-rounded">content_copy</span>
                                                    Copy to Clipboard
                                                </button>
                                            </div>
                                            <p class="menu-action-footnote">Export functionality is coming soon. These
                                                controls are placeholders for the upcoming workflow.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
</div>